<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>An introduction to Generalized Estimating Equations | Robert Greener</title><meta name=keywords content="statistics,R"><meta name=description content="How to assess the population average effect for longitudinal data"><meta name=author content="Robert Greener"><link rel=canonical href=https://r0bert.dev/posts/2020/08/05/gee-introduction/><link crossorigin=anonymous href=/assets/css/stylesheet.bc1149f4a72aa4858d3a9f71462f75e5884ffe8073ea9d6d5761d5663d651e20.css integrity="sha256-vBFJ9KcqpIWNOp9xRi915YhP/oBz6p1tV2HVZj1lHiA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://r0bert.dev/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://r0bert.dev/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://r0bert.dev/favicon-32x32.png><link rel=apple-touch-icon href=https://r0bert.dev/apple-touch-icon.png><link rel=mask-icon href=https://r0bert.dev/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="An introduction to Generalized Estimating Equations"><meta property="og:description" content="How to assess the population average effect for longitudinal data"><meta property="og:type" content="article"><meta property="og:url" content="https://r0bert.dev/posts/2020/08/05/gee-introduction/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-08-05T00:00:00+00:00"><meta property="article:modified_time" content="2020-08-05T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="An introduction to Generalized Estimating Equations"><meta name=twitter:description content="How to assess the population average effect for longitudinal data"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://r0bert.dev/posts/"},{"@type":"ListItem","position":3,"name":"An introduction to Generalized Estimating Equations","item":"https://r0bert.dev/posts/2020/08/05/gee-introduction/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"An introduction to Generalized Estimating Equations","name":"An introduction to Generalized Estimating Equations","description":"How to assess the population average effect for longitudinal data","keywords":["statistics","R"],"articleBody":"A key assumption underpinning generalized linear models (which linear regression is a type of) is the independence of observations. In longitudinal data this will simply not hold. Observations within an individual (between time points) are likely to be more similar than those between individuals.\nSo, how do you deal with this? One option is to fit a generalized linear mixed model in which there are random intercept and slope terms for each individual. This will tell you for a specific individual (i.e. conditional on the random intercept and slope) what is the effect of a variable on an outcome. However, this isn’t very useful if you are concerned with the marginal effect, i.e. what is the effect of a variable on an outcome on average in the population.\nIf you want to answer these population questions you need to fit a generalized linear model using generalized estimating equations (GEE). This is an approach that obtains the population average effect accounting for the fact that observations within individuals are likely to be more similar than those between individuals.\nAn example Suppose we have our outcome — all-cause mortality. Now suppose we record this every month for 10 months for every person. Now suppose our exposure, which is just time. We can now define a logistic regression model, with the sole independent variable being time (in months) and the dependent variable being death at that time. “Okay, great” I hear you say “but these observations are obviously not independent!”. Spot on, but we’ll come to that.\nWorking correlation structures To use GEE we must first define how time points are related. However, by using Huber-White standard errors our results will be consistent even if we misspecify this relationship! So we have some choices.\nIndependent This working correlation structure assumes that time points are independent of each other. This is probably an unreasonable assumption in practice.\nExchangeable This is where the correlation between observations at two time points is equal for any two time points. This is commonly used as it requires just one additional parameter α to be estimated.\nAutoregressive This is where the correlation between observations follows an autoregressive structure. Suppose we were using an AR-1 correlation matrix. This would mean that the correlation between month 1 and 2 of a person would be expected to be α and the correlation between month 1 and 3 of a person would be expected to be α², between month 1 and 4 would be α³ and so on.\nThis is most appropriate when you think closer together time points are more similar than further apart time points.\nUnstructured This is where we estimate a separate α for each possible combination of time points. This is the most general case. Though you need a lot of data to be able to estimate all of the α used.\nOther choices There do exist some other choices, but these aren’t widely used.\nHow to choose what one to use? It’s simple. Either choose the most general one your data can support (depending on sample size) or you can choose one you think suits the data best. Either way, don’t sweat it! This approach is consistent even if you misspecify this.\nHow to fit the model Fitting the model is simple. We just fit a GLM using GEE with our specified working correlation matrix:\n$$ \\begin{split} Y_{ij} \u0026= \\operatorname{Bernoulli}(p_{ij}) \\\\ \\operatorname{logit}(p_{ij}) \u0026= \\beta_0 + \\beta_1 T_{ij} \\end{split} $$\nWhere:\nYij is 1 if participant i died at time j pij is the probability of death for participant i at time j β0 is the population average log odds of death at time 0. This can be exponentiated to obtain the odds of death at time 0. β1 is the population average difference in log odds of death associated with a one-month increase in time. This can be exponentiated to obtain the odds ratio associated with a one-month increase in time. Tij is the time of the j’th measurement for participant i in months. That’s it. Our population average effect of a one-month increase on time increases the odds of death by an odds ratio of exp(β1).\nFitting a model in R We can do this in R using geepack. Suppose our dataframe already existed with three columns death time and person.id all we have to do is:\nlibrary(geepack) mod \u003c- geeglm( death ~ time, id = person.id, waves = time, family=binomial, corstr=\"exchangeable\" ) You can then just call summary(mod) as normal and get your results!\nAnd of course, you could add covariates to the model by just adding them to the formula. They can be time-varying or constant — either is fine!\nConclusion Hopefully you’ve come away from reading this with a basic idea of GEE. They should be a tool in the toolbox of any data scientist working with longitudinal data.\n","wordCount":"805","inLanguage":"en","datePublished":"2020-08-05T00:00:00Z","dateModified":"2020-08-05T00:00:00Z","author":{"@type":"Person","name":"Robert Greener"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://r0bert.dev/posts/2020/08/05/gee-introduction/"},"publisher":{"@type":"Organization","name":"Robert Greener","logo":{"@type":"ImageObject","url":"https://r0bert.dev/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://r0bert.dev accesskey=h title="Robert Greener (Alt + H)">Robert Greener</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://r0bert.dev/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://r0bert.dev/presentations/ title=Presentations><span>Presentations</span></a></li><li><a href=https://hg.sr.ht/~ragreener1 title=hg><span>hg</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://r0bert.dev/about/ title="Robert Greener"><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>An introduction to Generalized Estimating Equations</h1><div class=post-description>How to assess the population average effect for longitudinal data</div><div class=post-meta><span title='2020-08-05 00:00:00 +0000 UTC'>August 5, 2020</span>&nbsp;·&nbsp;Robert Greener</div></header><div class=post-content><p>A key assumption underpinning <em>generalized linear models</em> (which linear regression is a type of) is the independence of observations. In longitudinal data this will simply not hold. Observations within an individual (between time points) are likely to be more similar than those between individuals.</p><p>So, how do you deal with this? One option is to fit a generalized linear mixed model in which there are random intercept and slope terms for each individual. This will tell you for a specific individual (i.e. conditional on the random intercept and slope) what is the effect of a variable on an outcome. However, this isn’t very useful if you are concerned with the <em>marginal</em> effect, i.e. what is the effect of a variable on an outcome <em>on average</em> in the population.</p><p>If you want to answer these population questions you need to fit a generalized linear model using <em>generalized estimating equations</em> (GEE). This is an approach that obtains the population average effect accounting for the fact that observations within individuals are likely to be more similar than those between individuals.</p><h1 id=an-example>An example<a hidden class=anchor aria-hidden=true href=#an-example>#</a></h1><p>Suppose we have our <em>outcome</em> — all-cause mortality. Now suppose we record this every month for 10 months for every person. Now suppose our exposure, which is just time. We can now define a logistic regression model, with the sole independent variable being time (in months) and the dependent variable being death at that time. “Okay, great” I hear you say “but these observations are <em>obviously</em> not independent!”. Spot on, but we’ll come to that.</p><h1 id=working-correlation-structures>Working correlation structures<a hidden class=anchor aria-hidden=true href=#working-correlation-structures>#</a></h1><p>To use GEE we must first define how time points are related. However, by using <a href=https://en.wikipedia.org/wiki/Heteroscedasticity-consistent_standard_errors>Huber-White standard errors</a> our results will be <em>consistent</em> even if we misspecify this relationship! So we have some choices.</p><h2 id=independent>Independent<a hidden class=anchor aria-hidden=true href=#independent>#</a></h2><p>This working correlation structure assumes that time points are independent of each other. This is probably an unreasonable assumption in practice.</p><h2 id=exchangeable>Exchangeable<a hidden class=anchor aria-hidden=true href=#exchangeable>#</a></h2><p>This is where the correlation between observations at two time points is equal for any two time points. This is commonly used as it requires just one additional parameter α to be estimated.</p><h2 id=autoregressive>Autoregressive<a hidden class=anchor aria-hidden=true href=#autoregressive>#</a></h2><p>This is where the correlation between observations follows an autoregressive structure. Suppose we were using an AR-1 correlation matrix. This would mean that the correlation between month 1 and 2 of a person would be expected to be α and the correlation between month 1 and 3 of a person would be expected to be α², between month 1 and 4 would be α³ and so on.</p><p>This is most appropriate when you think closer together time points are more similar than further apart time points.</p><h2 id=unstructured>Unstructured<a hidden class=anchor aria-hidden=true href=#unstructured>#</a></h2><p>This is where we estimate a separate α for each possible combination of time points. This is the most general case. Though you need a lot of data to be able to estimate all of the α used.</p><h2 id=other-choices>Other choices<a hidden class=anchor aria-hidden=true href=#other-choices>#</a></h2><p>There do exist some other choices, but these aren’t widely used.</p><h2 id=how-to-choose-what-one-to-use>How to choose what one to use?<a hidden class=anchor aria-hidden=true href=#how-to-choose-what-one-to-use>#</a></h2><p>It’s simple. Either choose the most general one your data can support (depending on sample size) or you can choose one you think suits the data best. Either way, don’t sweat it! This approach is consistent even if you misspecify this.</p><h1 id=how-to-fit-the-model>How to fit the model<a hidden class=anchor aria-hidden=true href=#how-to-fit-the-model>#</a></h1><p>Fitting the model is simple. We just fit a GLM using GEE with our specified working correlation matrix:</p><p>$$
\begin{split}
Y_{ij} &= \operatorname{Bernoulli}(p_{ij}) \\
\operatorname{logit}(p_{ij}) &= \beta_0 + \beta_1 T_{ij}
\end{split}
$$</p><p>Where:</p><ul><li>Yij is 1 if participant i died at time j</li><li>pij is the probability of death for participant i at time j</li><li>β0 is the population average log odds of death at time 0. This can be exponentiated to obtain the odds of death at time 0.</li><li>β1 is the population average difference in log odds of death associated with a one-month increase in time. This can be exponentiated to obtain the odds ratio associated with a one-month increase in time.</li><li>Tij is the time of the j’th measurement for participant i in months.</li></ul><p>That’s it. Our population average effect of a one-month increase on time increases the odds of death by an odds ratio of exp(β1).</p><h2 id=fitting-a-model-in-r>Fitting a model in R<a hidden class=anchor aria-hidden=true href=#fitting-a-model-in-r>#</a></h2><p>We can do this in R using <a href=https://rdrr.io/cran/geepack/man/geeglm.html>geepack</a>. Suppose our dataframe already existed with three columns <code>death</code> <code>time</code> and <code>person.id</code> all we have to do is:</p><pre tabindex=0><code>library(geepack)  
mod &lt;- geeglm(
    death ~ time,
    id = person.id,
    waves = time,
    family=binomial,
    corstr=&#34;exchangeable&#34;
)
</code></pre><p>You can then just call <code>summary(mod)</code> as normal and get your results!</p><p>And of course, you could add covariates to the model by just adding them to the formula. They can be time-varying or constant — either is fine!</p><h1 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h1><p>Hopefully you’ve come away from reading this with a basic idea of GEE. They should be a tool in the toolbox of any data scientist working with longitudinal data.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://r0bert.dev/tags/statistics/>statistics</a></li><li><a href=https://r0bert.dev/tags/r/>R</a></li></ul></footer><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){this.page.url="https://r0bert.dev/posts/2020/08/05/gee-introduction/",this.page.identifier="https://r0bert.dev/posts/2020/08/05/gee-introduction/",this.page.title="An introduction to Generalized Estimating Equations"};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//r0bert-dev.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><footer class=footer><span>&copy; CC-BY-4.0 2022 <a href=https://r0bert.dev>Robert Greener</a></span></footer><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script>
<script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>